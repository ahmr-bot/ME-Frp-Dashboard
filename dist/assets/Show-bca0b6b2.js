import{b as E}from"./vue-router-c4b6792e.js";import{H as C}from"./humanize-plus-926755d6.js";import{i as F}from"./http-78f45fb6.js";import{i as H}from"./echarts-dc442d78.js";import{m as Y}from"./layout-4b72ee2f.js";import{c as $,a6 as L,Z as d,d as M,O as I,N as _,a3 as b,a7 as P,Y as V,a4 as j}from"./naive-ui-24262aab.js";import{r as y,j as G,D as Q,n as R,c as T,a as l,O as i,P as n,I as t,Y as x,F as U,o as p,e as k,S as v,Q as W}from"./@vue-fa1c5c1f.js";import"./date-fns-bca8c9b2.js";import"./axios-c47e0cf1.js";import"./form-data-d2a9677b.js";import"./router-325b049e.js";import"./user-a1f28023.js";import"./vuex-3133efbc.js";import"./500-07d896ca.js";import"./Lottie-739291b6.js";import"./lottie-web-94c7854d.js";import"./seemly-4f9c12c5.js";import"./vueuc-ea3f9c0c.js";import"./evtd-b614532e.js";import"./@css-render-43d82e32.js";import"./vooks-16fcc23f.js";import"./vdirs-b0483831.js";import"./@juggle-41516555.js";import"./css-render-d3958e6a.js";import"./@emotion-8a8e73f6.js";import"./lodash-es-cabc0acd.js";import"./treemate-25c27bff.js";import"./async-validator-dee29e8b.js";import"./404-cdb51896.js";import"./tslib-54e39b60.js";import"./zrender-35d94477.js";const Z=l("div",null,[l("div",{id:"chart",style:{height:"400px"}})],-1),q={key:0},J=l("span",null,"点击复制",-1),K=l("span",null,"点击复制",-1),X=l("span",null,"点击复制",-1),ee=l("div",{class:"mt-80"},null,-1),Be={__name:"Show",setup(te){const O=E(),w=y(!1),a=y({name:"",status:"running",traffic:{traffic_in:[],traffic_out:[]},server:{server_address:""},tunnel:{conf:{}}});let s,u={tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:function(r){let e="";r.length>0&&(e+=r[0].name+"<br/>");for(let o of r){let c='<span style="display:inline-block;margin-right:5px;border-radius:10px;width:9px;height:9px;background-color:'+o.color+'"></span>';e+=`${c+o.seriesName}: ${C.fileSize(o.value)}<br/>`}return e}},legend:{data:["入站流量","出站流量"]},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",data:[]}],yAxis:[{type:"value",axisLabel:{formatter:function(r){return C.fileSize(r)}}}],series:[{name:"入站流量",type:"bar",data:[]},{name:"出站流量",type:"bar",data:[]}]};function g(r){navigator.clipboard.writeText(r),Y.success("复制成功")}function N(){let r=document.getElementById("chart");s=H(r,{backgroundColor:"transparent",renderer:"svg"}),u&&s.setOption(u)}const f=y("success");function z(){F.get("/modules/frp/hosts/"+O.params.id).then(r=>{if(a.value=r.data,a.value.status==="running"?f.value="success":a.value.status==="stopped"?f.value="error":a.value.status==="suspended"?f.value="warning":f.value="info",r.data.traffic){w.value||(w.value=!0);let e=new Date;e=new Date(e.getFullYear(),e.getMonth(),e.getDate()-6);let o=[];for(let D=0;D<7;D++)o.push(e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()),e=new Date(e.getFullYear(),e.getMonth(),e.getDate()+1);u.xAxis[0].data=o;let c=r.data.traffic.traffic_in,m=r.data.traffic.traffic_out;if(!c||!m)return;c=c.reverse(),m=m.reverse(),s&&(u.series[0].data=c,u.series[1].data=m,s.setOption(u))}})}z();let h=setInterval(()=>{s&&s.resize()});G(()=>{N(),window.addEventListener("resize",()=>{s&&s.resize()})});const S=setInterval(z,1e4);Q(()=>{clearInterval(S),h&&clearInterval(h),window.removeEventListener("resize",()=>{h=setInterval(()=>{s&&s.resize()},1e3),N(),s&&s.resize()})});const A=[{title:"键名",key:"key"},{title:"值",key:"value"}];let B=R(()=>{let r=[];const e=a.value.tunnel.conf;for(const o in e)e[o]!==null&&r.push({key:o,value:e[o].toString()});return r});return(r,e)=>(p(),T(U,null,[l("div",null,[i(t($),{type:f.value,"align-text":"",prefix:"bar"},{default:n(()=>[i(t(L),{type:f.value},{default:n(()=>[k(v(a.value.name),1)]),_:1},8,["type"])]),_:1},8,["type"]),Z,i(t(V),{animated:"",type:"line"},{default:n(()=>[i(t(d),{name:"status",tab:"隧道状态"},{default:n(()=>[i(t(M),{prefix:"bar"},{default:n(()=>[k("连接信息")]),_:1}),a.value.protocol==="http"||a.value.protocol==="https"?(p(),x(t(I),{key:0,prefix:"bar"},{default:n(()=>[k("域名解析到: "+v(a.value.server.server_address),1)]),_:1})):(p(),x(t(I),{key:1,prefix:"bar"},{default:n(()=>[a.value.server.server_address!==""?(p(),T("span",q,"使用 "+v(a.value.server.server_address)+":"+v(a.value.remote_port)+" 来连接到服务器",1)):W("",!0)]),_:1}))]),_:1}),i(t(d),{name:"config_all",tab:"全部配置"},{default:n(()=>[i(t(_),{trigger:"hover"},{trigger:n(()=>[i(t(b),{code:a.value.config.server+`

`+a.value.config.client,language:"ini","show-line-numbers":"",trim:"",onClick:e[0]||(e[0]=o=>g(a.value.config.client))},null,8,["code"])]),default:n(()=>[J]),_:1})]),_:1}),i(t(d),{name:"server",tab:"服务端"},{default:n(()=>[i(t(_),{trigger:"hover"},{trigger:n(()=>[i(t(b),{code:a.value.config.server,language:"ini","show-line-numbers":"",trim:"",onClick:e[1]||(e[1]=o=>g(a.value.config.client))},null,8,["code"])]),default:n(()=>[K]),_:1})]),_:1}),i(t(d),{name:"client",tab:"客户端"},{default:n(()=>[i(t(_),{trigger:"hover"},{trigger:n(()=>[i(t(b),{code:a.value.config.client,language:"ini","show-line-numbers":"",trim:"",onClick:e[2]||(e[2]=o=>g(a.value.config.client))},null,8,["code"])]),default:n(()=>[X]),_:1})]),_:1}),i(t(d),{name:"post_config",tab:"传入配置"},{default:n(()=>[i(t(P),{bordered:!0,columns:A,data:t(B)},null,8,["data"])]),_:1})]),_:1}),ee]),(p(),x(t(j),{key:0,content:"别泄漏隧道名和 Token",cross:"",fullscreen:"","font-size":16,"line-height":16,width:384,height:384,"x-offset":12,"y-offset":60,rotate:-15}))],64))}};export{Be as default};
