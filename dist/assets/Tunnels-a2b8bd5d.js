import{r as y,o as l,c as g,Y as n,P as s,F as k,a1 as P,I as t,O as o,W as B,e as i,Q as S,S as d,X as h}from"./@vue-fa1c5c1f.js";import{u as I}from"./composables-b6ff6339.js";import{r as L}from"./router-325b049e.js";import{i as _}from"./http-78f45fb6.js";import{t as b}from"./tunnels-ebd61d86.js";import{d as N}from"./layout-4b72ee2f.js";import{L as V,U as F,n as q,o as A,M as D,T as E,i as K,P as u,a as G,R as J,J as x,V as O}from"./naive-ui-24262aab.js";const Q={key:1},$={__name:"Tunnels",props:{tunnels:{type:Array,required:!0},next:{type:Function,required:!1}},setup(c){const C=I();function w(a){L.push({name:"modules.tunnels.show",params:{id:a}})}const p=y({host_id:0,name:""}),f=y(!1);function T(a){p.value=a,a.status==="delete"?N.warning({title:"注意！",content:"你正在删除一个隧道！",positiveText:"删除",negativeText:"不对",onPositiveClick:()=>{_.delete("/modules/frp/hosts/"+a.host_id).then(()=>{b.dispatch("fetchTunnels")})},onNegativeClick:()=>{a.status="running"}}):a.status==="stopped"?N.warning({title:"你正在断开连接！",content:"停止一个隧道，将断开 frpc 客户端连接！",positiveText:"关闭",negativeText:"不对",onPositiveClick:()=>{v({status:a.status})},onNegativeClick:()=>{a.status="running"}}):a.status==="rename"?(f.value=!0,a.status="running"):v({status:a.status})}const z=()=>{f.value=!1,v({name:p.value.name})};function v(a={}){_.patch(`/modules/frp/hosts/${p.value.host_id}`,a).finally(()=>{b.dispatch("fetchTunnels")})}const U=y([{label:"停用",value:"stopped"},{label:"启用",value:"running"},{label:"删除",value:"delete"},{label:"改名",value:"rename"}]);return(a,r)=>(l(),g(k,null,[c.tunnels.length>0?(l(),n(t(V),{key:0,clickable:"",hoverable:""},{default:s(()=>[(l(!0),g(k,null,P(c.tunnels,(e,M)=>(l(),n(t(D),{key:M,onClick:m=>c.next(e)},{default:s(()=>[o(t(E),{title:"#"+e.host_id+" "+e.name,"content-style":"margin-top: 10px;"},{description:s(()=>[o(t(K),{size:"small",style:{"margin-top":"4px"}},{default:s(()=>[e.status==="running"?(l(),n(t(u),{key:0,bordered:!1,size:"small",type:"success"},{default:s(()=>[i(" 正常 ")]),_:1})):e.status==="delete"?(l(),n(t(u),{key:1,bordered:!1,size:"small",type:"error"},{default:s(()=>[i(" 删除中 ")]),_:1})):e.status==="stopped"?(l(),n(t(u),{key:2,bordered:!1,size:"small",type:"error"},{default:s(()=>[i(" 停止 ")]),_:1})):e.status==="suspended"?(l(),n(t(u),{key:3,bordered:!1,size:"small",type:"warning"},{default:s(()=>[i(" 暂停 ")]),_:1})):S("",!0),o(t(u),{bordered:!1,size:"small",type:"info"},{default:s(()=>[i(d(e.protocol.toUpperCase()),1)]),_:2},1024),e.custom_domain?(l(),n(t(u),{key:4,bordered:!1,size:"small",type:"info"},{default:s(()=>[i(d(e.custom_domain),1)]),_:2},1024)):(l(),n(t(u),{key:5,bordered:!1,size:"small",type:"info"},{default:s(()=>[i(d(e.remote_port),1)]),_:2},1024)),o(t(u),{bordered:!1,size:"small",type:"info"},{default:s(()=>[i(d(e.local_address),1)]),_:2},1024)]),_:2},1024)]),avatar:s(()=>[o(t(G),null,{default:s(()=>[i(d(e.name.toUpperCase().substring(0,1)),1)]),_:2},1024)]),"header-extra":s(()=>[o(t(J),{onClick:r[0]||(r[0]=h(()=>{},["stop"]))},{default:s(()=>[o(t(x),{ghost:"",type:"info",onClick:h(m=>w(e.host_id),["stop"])},{default:s(()=>[i(d(t(C)?"信息":"详细信息"),1)]),_:2},1032,["onClick"]),o(t(O),{value:e.status,"onUpdate:value":[m=>e.status=m,m=>T(e)],options:U.value,size:"large"},{default:s(()=>[o(t(x),{slot:"trigger",ghost:"",type:"success"},{default:s(()=>[i(" 操作 ")]),_:1})]),_:2},1032,["value","onUpdate:value","options"])]),_:2},1024)]),_:2},1032,["title"])]),_:2},1032,["onClick"]))),128))]),_:1})):(l(),g("div",Q,[o(t(F),{description:"您还没有创建任何隧道。"})])),o(t(A),{show:f.value,"onUpdate:show":r[3]||(r[3]=e=>f.value=e),"negative-text":"算了","positive-text":"确认",preset:"dialog",title:"修改名称",onPositiveClick:z},{default:s(()=>[o(t(q),{value:p.value.name,"onUpdate:value":r[1]||(r[1]=e=>p.value.name=e),onKeydown:r[2]||(r[2]=B(h(()=>{},["prevent"]),["enter"]))},null,8,["value"])]),_:1},8,["show"])],64))}};export{$ as _};
