import{r as u,c as r,O as t,a as o,P as i,I as a,Q as v,z as T,v as N,e as n,o as s}from"./@vue-fa1c5c1f.js";import{i as C}from"./http-78f45fb6.js";import{r as k}from"./router-325b049e.js";import{c as B}from"./layout-4b72ee2f.js";import{u as c}from"./user-a1f28023.js";import{_ as d}from"./Lottie-739291b6.js";import{c as x,J as y,S as V}from"./naive-ui-24262aab.js";import"./axios-c47e0cf1.js";import"./form-data-d2a9677b.js";import"./vuex-3133efbc.js";import"./500-07d896ca.js";import"./lottie-web-94c7854d.js";import"./date-fns-bca8c9b2.js";import"./seemly-4f9c12c5.js";import"./vueuc-ea3f9c0c.js";import"./evtd-b614532e.js";import"./@css-render-43d82e32.js";import"./vooks-16fcc23f.js";import"./vdirs-b0483831.js";import"./@juggle-41516555.js";import"./css-render-d3958e6a.js";import"./@emotion-8a8e73f6.js";import"./lodash-es-cabc0acd.js";import"./treemate-25c27bff.js";import"./async-validator-dee29e8b.js";import"./404-cdb51896.js";import"./vue-router-c4b6792e.js";const L={key:0},S={class:"text-center"},b={key:1},I={key:2},P={class:"text-center"},U={class:"text-center mt-5"},q=o("span",null,"莱云的 logo 动画由 Fofray 制作。",-1),R=[q],z={key:3,class:"text-center mt-5"},A=o("br",null,null,-1),D=o("a",{href:"https://beian.miit.gov.cn/"},"苏ICP备2022042268号-1",-1),_t={__name:"Login",setup(E){const l={textAlign:"center",marginTop:"20px",marginBottom:"20px"},_=B.auth;console.log("auth server: "+_);const p=u(""),e=u("redirect"),w=()=>{e.value="logging",c.commit("updateToken",p.value),C.get("/user").then(m=>{setTimeout(()=>{c.commit("updateToken",p.value),c.commit("updateUser",m.data),k.push("/"),location.href="/"},1e3)}).catch(()=>{e.value="error",c.commit("updateToken",""),c.commit("updateUser",{})})},h=k.currentRoute.value.query;h.token!=null&&(p.value=h.token,w());function f(){const m=location.origin+location.pathname;window.location.href=_+"/?callback="+encodeURIComponent(m)}const g=u("Logo-dark");return window.matchMedia("(prefers-color-scheme: dark)").matches&&(g.value="Logo-white"),(m,F)=>(s(),r("div",null,[e.value==="redirect"?(s(),r("div",L,[t(d,{height:256,style:l,name:"Wave"}),o("div",S,[t(a(x),null,{default:i(()=>[n("欢迎！要一起加入莱云吗？")]),_:1}),t(a(y),{class:"text-center",type:"info",onClick:f},{default:i(()=>[n(" 现在登录！ ")]),_:1})])])):e.value==="logging"?(s(),r("div",b,[t(d,{height:256,name:g.value,style:l},null,8,["name"])])):e.value==="error"?(s(),r("div",I,[t(d,{height:256,style:l,name:"Ghost"}),o("div",P,[t(a(x),{class:"mt-5"},{default:i(()=>[t(a(V),{class:"text-center",type:"error"},{default:i(()=>[n(" 你的 Token 无效 ")]),_:1})]),_:1}),t(a(y),{type:"error",onClick:f},{default:i(()=>[n(" 重新登录 ")]),_:1})])])):v("",!0),T(o("p",U,R,512),[[N,e.value==="logging"]]),e.value==="redirect"?(s(),r("p",z,[n(" 莱云 iVampireSP.com 作品 "),A,D])):v("",!0)]))}};export{_t as default};
